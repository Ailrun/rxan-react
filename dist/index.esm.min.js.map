{"version":3,"file":"index.esm.min.js","sources":["../src/withRxan.js"],"sourcesContent":["import React from 'react'\n\nconst withRxan = (value$, config) => (C) => {\n  if (config.startPropName !== undefined) {\n    console.warn('Config \\'startPropName\\' is deprecated. Please use \\'mapAnimationToProps\\' instead.')\n  }\n\n  if (config.stopPropName !== undefined) {\n    console.warn('Config \\'stopPropName\\' is deprecated. Please use \\'mapAnimationToProps\\' instead.')\n  }\n\n  if (config.valuePropName !== undefined) {\n    console.warn('Config \\'valuePropName\\' is deprecated. Please use \\'mapAnimationToProps\\' instead.')\n  }\n\n  config = {\n    startPropName: 'start',\n    stopPropName: 'stop',\n    valuePropName: 'value',\n    autoStartAt: 'nothing',\n    stopBeforeAutoStart: false,\n    mapAnimationToProps(value, start, stop) {\n      return {\n        [this.valuePropName]: value,\n        [this.startPropName]: start,\n        [this.stopPropName]: stop,\n      }\n    },\n    ...config,\n  }\n\n  switch (config.autoStartAt) {\n  case 'nothing':\n  case 'constructor':\n  case 'componentDidMount':\n  case 'componentWillUpdate':\n  case 'componentDidUpdate':\n    break\n  default:\n    console.error(`Config autoStartAt has invalid value.\\\n It should be one of the following.\n    undefined\n    'nothing'\n    'constructor'\n    'componentDidMount'\n    'componentWillUpdate'\n    'componentDidUpdate'`)\n  }\n\n  return class extends React.Component {\n    constructor(props, context) {\n      super(props, context)\n\n      this.state = {\n        lastValue: undefined,\n      }\n      this.subscription = undefined\n\n      this.autoStart = this.autoStart.bind(this)\n      this.start = this.start.bind(this)\n      this.stop = this.stop.bind(this)\n\n      if (config.autoStartAt === 'constructor') {\n        this.autoStart()\n      }\n    }\n\n    componentDidMount() {\n      if (config.autoStartAt === 'componentDidMount') {\n        this.autoStart()\n      }\n    }\n\n    componentWillUpdate() {\n      if (config.autoStartAt === 'componentWillUpdate') {\n        this.autoStart()\n      }\n    }\n\n    componentDidUpdate() {\n      if (config.autoStartAt === 'componentDidUpdate') {\n        this.autoStart()\n      }\n    }\n\n    componentWillUnmount() {\n      this.stop()\n    }\n\n    autoStart() {\n      if (config.stopBeforeAutoStart) {\n        this.stop()\n      }\n\n      this.start()\n    }\n\n    start() {\n      if (!this.subscription) {\n        this.subscription = value$.subscribe((v) => {\n          this.setState({\n            lastValue: v,\n          })\n        }, undefined, () => {\n          this.stop()\n        })\n      }\n    }\n\n    stop() {\n      if (this.subscription) {\n        this.subscription.unsubscribe()\n        this.subscription = undefined\n      }\n    }\n\n    render() {\n      const addedProps =\n        config.mapAnimationToProps(this.state.lastValue, this.start, this.stop)\n\n      return (\n        <C {...this.props} {...addedProps} />\n      )\n    }\n  }\n}\nexport {\n  withRxan,\n}\n"],"names":["withRxan","value$","config","C","undefined","startPropName","console","warn","stopPropName","valuePropName","autoStartAt","stopBeforeAutoStart","mapAnimationToProps","value","start","stop","this","error","props","context","state","lastValue","subscription","autoStart","_this","bind","React","Component","subscribe","v","_this2","setState","unsubscribe","addedProps"],"mappings":"4jCAEMA,EAAW,SAACC,EAAQC,UAAW,SAACC,eACPC,IAAzBF,EAAOG,eACTC,QAAQC,KAAK,wFAGaH,IAAxBF,EAAOM,cACTF,QAAQC,KAAK,uFAGcH,IAAzBF,EAAOO,eACTH,QAAQC,KAAK,oFAGfL,mWACEG,cAAe,QACfG,aAAc,OACdC,cAAe,QACfC,YAAa,UACbC,qBAAqB,EACrBC,6BAAoBC,EAAOC,EAAOC,uBAE7BC,KAAKP,cAAgBI,OACrBG,KAAKX,cAAgBS,OACrBE,KAAKR,aAAeO,OAGtBb,IAGUQ,iBACV,cACA,kBACA,wBACA,0BACA,mCAGHJ,QAAQW,+OAWIC,EAAOC,sJACXD,EAAOC,sDAERC,MAAQ,CACXC,eAAWjB,KAERkB,kBAAelB,IAEfmB,UAAYC,EAAKD,UAAUE,aAC3BX,MAAQU,EAAKV,MAAMW,aACnBV,KAAOS,EAAKT,KAAKU,WAEK,gBAAvBvB,EAAOQ,eACJa,oQAdUG,EAAMC,6DAmBI,sBAAvBzB,EAAOQ,kBACJa,0DAKoB,wBAAvBrB,EAAOQ,kBACJa,yDAKoB,uBAAvBrB,EAAOQ,kBACJa,gEAKFR,2CAIDb,EAAOS,0BACJI,YAGFD,mDAIAE,KAAKM,oBACHA,aAAerB,EAAO2B,WAAU,SAACC,GACpCC,EAAKC,SAAS,CACZV,UAAWQ,WAEZzB,GAAW,WACZ0B,EAAKf,0CAMLC,KAAKM,oBACFA,aAAaU,mBACbV,kBAAelB,wCAKhB6B,EACJ/B,EAAOU,oBAAoBI,KAAKI,MAAMC,UAAWL,KAAKF,MAAOE,KAAKD,aAGlEW,gBAACvB,OAAMa,KAAKE,MAAWe"}