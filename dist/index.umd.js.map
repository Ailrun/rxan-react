{"version":3,"file":"index.umd.js","sources":["../src/withRxan.js"],"sourcesContent":["import React from 'react'\n\nconst withRxan = (value$, config) => (C) => {\n  if (config.startPropName !== undefined) {\n    console.warn('Config \\'startPropName\\' is deprecated. Please use \\'mapAnimationToProps\\' instead.')\n  }\n\n  if (config.stopPropName !== undefined) {\n    console.warn('Config \\'stopPropName\\' is deprecated. Please use \\'mapAnimationToProps\\' instead.')\n  }\n\n  if (config.valuePropName !== undefined) {\n    console.warn('Config \\'valuePropName\\' is deprecated. Please use \\'mapAnimationToProps\\' instead.')\n  }\n\n  config = {\n    startPropName: 'start',\n    stopPropName: 'stop',\n    valuePropName: 'value',\n    autoStartAt: 'nothing',\n    stopBeforeAutoStart: false,\n    mapAnimationToProps(value, start, stop) {\n      return {\n        [this.valuePropName]: value,\n        [this.startPropName]: start,\n        [this.stopPropName]: stop,\n      }\n    },\n    ...config,\n  }\n\n  switch (config.autoStartAt) {\n  case 'nothing':\n  case 'constructor':\n  case 'componentDidMount':\n  case 'componentWillUpdate':\n  case 'componentDidUpdate':\n    break\n  default:\n    console.error(`Config autoStartAt has invalid value.\\\n It should be one of the following.\n    undefined\n    'nothing'\n    'constructor'\n    'componentDidMount'\n    'componentWillUpdate'\n    'componentDidUpdate'`)\n  }\n\n  return class extends React.Component {\n    constructor(props, context) {\n      super(props, context)\n\n      this.state = {\n        lastValue: undefined,\n      }\n      this.subscription = undefined\n\n      this.autoStart = this.autoStart.bind(this)\n      this.start = this.start.bind(this)\n      this.stop = this.stop.bind(this)\n\n      if (config.autoStartAt === 'constructor') {\n        this.autoStart()\n      }\n    }\n\n    componentDidMount() {\n      if (config.autoStartAt === 'componentDidMount') {\n        this.autoStart()\n      }\n    }\n\n    componentWillUpdate() {\n      if (config.autoStartAt === 'componentWillUpdate') {\n        this.autoStart()\n      }\n    }\n\n    componentDidUpdate() {\n      if (config.autoStartAt === 'componentDidUpdate') {\n        this.autoStart()\n      }\n    }\n\n    componentWillUnmount() {\n      this.stop()\n    }\n\n    autoStart() {\n      if (config.stopBeforeAutoStart) {\n        this.stop()\n      }\n\n      this.start()\n    }\n\n    start() {\n      if (!this.subscription) {\n        this.subscription = value$.subscribe((v) => {\n          this.setState({\n            lastValue: v,\n          })\n        }, undefined, () => {\n          this.stop()\n        })\n      }\n    }\n\n    stop() {\n      if (this.subscription) {\n        this.subscription.unsubscribe()\n        this.subscription = undefined\n      }\n    }\n\n    render() {\n      const addedProps =\n        config.mapAnimationToProps(this.state.lastValue, this.start, this.stop)\n\n      return (\n        <C {...this.props} {...addedProps} />\n      )\n    }\n  }\n}\nexport {\n  withRxan,\n}\n"],"names":["withRxan","value$","config","C","startPropName","undefined","console","warn","stopPropName","valuePropName","autoStartAt","stopBeforeAutoStart","mapAnimationToProps","value","start","stop","error","props","context","state","lastValue","subscription","autoStart","bind","subscribe","v","setState","unsubscribe","addedProps","React","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAEMA,QAAQ,GAAG,SAAXA,QAAW,CAACC,MAAD,EAASC,MAAT;EAAA,SAAoB,UAACC,CAAD,EAAO;EAC1C,QAAID,MAAM,CAACE,aAAP,KAAyBC,SAA7B,EAAwC;EACtCC,MAAAA,OAAO,CAACC,IAAR,CAAa,qFAAb;EACD;;EAED,QAAIL,MAAM,CAACM,YAAP,KAAwBH,SAA5B,EAAuC;EACrCC,MAAAA,OAAO,CAACC,IAAR,CAAa,oFAAb;EACD;;EAED,QAAIL,MAAM,CAACO,aAAP,KAAyBJ,SAA7B,EAAwC;EACtCC,MAAAA,OAAO,CAACC,IAAR,CAAa,qFAAb;EACD;;EAEDL,IAAAA,MAAM;EACJE,MAAAA,aAAa,EAAE,OADX;EAEJI,MAAAA,YAAY,EAAE,MAFV;EAGJC,MAAAA,aAAa,EAAE,OAHX;EAIJC,MAAAA,WAAW,EAAE,SAJT;EAKJC,MAAAA,mBAAmB,EAAE,KALjB;EAMJC,MAAAA,mBANI,+BAMgBC,KANhB,EAMuBC,KANvB,EAM8BC,IAN9B,EAMoC;EAAA;;EACtC,gDACG,KAAKN,aADR,EACwBI,KADxB,yBAEG,KAAKT,aAFR,EAEwBU,KAFxB,yBAGG,KAAKN,YAHR,EAGuBO,IAHvB;EAKD;EAZG,OAaDb,MAbC,CAAN;;EAgBA,YAAQA,MAAM,CAACQ,WAAf;EACA,WAAK,SAAL;EACA,WAAK,aAAL;EACA,WAAK,mBAAL;EACA,WAAK,qBAAL;EACA,WAAK,oBAAL;EACE;;EACF;EACEJ,QAAAA,OAAO,CAACU,KAAR;EARF;;EAkBA;EAAA;;EACE,wBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;EAAA;;EAAA;;EAC1B,sFAAMD,KAAN,EAAaC,OAAb;EAEA,gBAAKC,KAAL,GAAa;EACXC,YAAAA,SAAS,EAAEf;EADA,WAAb;EAGA,gBAAKgB,YAAL,GAAoBhB,SAApB;EAEA,gBAAKiB,SAAL,GAAiB,MAAKA,SAAL,CAAeC,IAAf,+BAAjB;EACA,gBAAKT,KAAL,GAAa,MAAKA,KAAL,CAAWS,IAAX,+BAAb;EACA,gBAAKR,IAAL,GAAY,MAAKA,IAAL,CAAUQ,IAAV,+BAAZ;;EAEA,cAAIrB,MAAM,CAACQ,WAAP,KAAuB,aAA3B,EAA0C;EACxC,kBAAKY,SAAL;EACD;;EAdyB;EAe3B;;EAhBH;EAAA;EAAA,8CAkBsB;EAClB,gBAAIpB,MAAM,CAACQ,WAAP,KAAuB,mBAA3B,EAAgD;EAC9C,mBAAKY,SAAL;EACD;EACF;EAtBH;EAAA;EAAA,gDAwBwB;EACpB,gBAAIpB,MAAM,CAACQ,WAAP,KAAuB,qBAA3B,EAAkD;EAChD,mBAAKY,SAAL;EACD;EACF;EA5BH;EAAA;EAAA,+CA8BuB;EACnB,gBAAIpB,MAAM,CAACQ,WAAP,KAAuB,oBAA3B,EAAiD;EAC/C,mBAAKY,SAAL;EACD;EACF;EAlCH;EAAA;EAAA,iDAoCyB;EACrB,iBAAKP,IAAL;EACD;EAtCH;EAAA;EAAA,sCAwCc;EACV,gBAAIb,MAAM,CAACS,mBAAX,EAAgC;EAC9B,mBAAKI,IAAL;EACD;;EAED,iBAAKD,KAAL;EACD;EA9CH;EAAA;EAAA,kCAgDU;EAAA;;EACN,gBAAI,CAAC,KAAKO,YAAV,EAAwB;EACtB,mBAAKA,YAAL,GAAoBpB,MAAM,CAACuB,SAAP,CAAiB,UAACC,CAAD,EAAO;EAC1C,gBAAA,MAAI,CAACC,QAAL,CAAc;EACZN,kBAAAA,SAAS,EAAEK;EADC,iBAAd;EAGD,eAJmB,EAIjBpB,SAJiB,EAIN,YAAM;EAClB,gBAAA,MAAI,CAACU,IAAL;EACD,eANmB,CAApB;EAOD;EACF;EA1DH;EAAA;EAAA,iCA4DS;EACL,gBAAI,KAAKM,YAAT,EAAuB;EACrB,mBAAKA,YAAL,CAAkBM,WAAlB;EACA,mBAAKN,YAAL,GAAoBhB,SAApB;EACD;EACF;EAjEH;EAAA;EAAA,mCAmEW;EACP,gBAAMuB,UAAU,GACd1B,MAAM,CAACU,mBAAP,CAA2B,KAAKO,KAAL,CAAWC,SAAtC,EAAiD,KAAKN,KAAtD,EAA6D,KAAKC,IAAlE,CADF;EAGA,mBACE,oBAAC,CAAD,eAAO,KAAKE,KAAZ,EAAuBW,UAAvB,EADF;EAGD;EA1EH;;EAAA;EAAA,QAAqBC,KAAK,CAACC,SAA3B;EAAA;EA4ED,GA3HgB;EAAA;;;;;;;;;;;;"}